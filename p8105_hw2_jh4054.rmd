---
title: "p8105_hw2_jh4054"
author: "Joy Hsu"
date: "10/4/2018"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: show
---

This R Markdown for hw2 reinforces skills from Data Wrangling.

### Setup

Load packages and set specifications for visual outputs
```{r setup, collapse=TRUE}
#load packages
library(tidyverse)
library(ggridges)
library(janitor)
library(readxl)
library(patchwork)

#set output specifications for visuals
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```

### Problem 1

```{r, collapse=TRUE}
#read & clean data files
nyc_trans = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line:entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

1. Write a short paragraph about this dataset â€“ explain briefly what variables the dataset contains, describe your data cleaning steps so far, and give the dimension (rows x columns) of the resulting dataset. Are these data tidy?

The NYC Transit dataset describes parameters for every entrance and exit in each NYC subway station. Details for each location include coordinates, routes served, vending, staffing, and ADA compliance. Inital cleaning involved 1) changing variable names to snake case, 2) mutating the `entry` variable from a character to logical variable - `TRUE` for the presence of an entry and `FALSE` no entry. Additionally, only select variables of interest were retained: line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. The initial dataset is untidy, each route number is listed as a separate variable with the route name as value. After abovementioned cleaning steps, the dimensions of the resulting dataset is `r dim(nyc_trans)`

2. Answer the following questions using these data:

* How many distinct stations are there? Note that stations are identified both by name and by line (e.g. 125th St A/B/C/D; 125st 1; 125st 4/5); the distinct function may be useful here.
* How many stations are ADA compliant? 
* What proportion of station entrances / exits without vending allow entrance?
* Reformat data so that route number and route name are distinct variables. How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant? --> need to tidy data 

Further details:

1. There are 465 distinct stations, identified by name and line
2. There are 84 ADA compliant stations
3. 38% of station entrances/exits without vending allow entrance

```{r, collapse=TRUE}
#dimensions
dim(nyc_trans)

#1. number of distinct stations, identified by name and line
distinct(nyc_trans, line, station_name) %>% 
  nrow()

#2. number of ADA compliant stations
nyc_trans %>% 
  filter(ada == TRUE) %>%
  distinct(line, station_name) %>% 
  nrow()

#3. proprotion of station entrances/exits without vending that allow entrance
nrow(
  filter(nyc_trans, vending == "NO" & entry == "TRUE")) /
nrow(
  filter(nyc_trans, vending == "NO"))
```

```{r}
#Reformat data so that route number and route name are distinct variables
nyc_trans_tidy = gather(nyc_trans, key = route_number, value = route_name, route1:route11, na.rm = TRUE)

#56 distinct stations serve the A train. 
nrow(nyc_trans_tidy %>% 
  filter(route_name == "A") %>% 
  distinct(station_name, keep_all = TRUE))

#16 stations that serve the A train are ADA compliant
nrow(nyc_trans_tidy %>% 
  filter(route_name == "A", ada == TRUE) %>% 
  distinct(station_name, keep_all = TRUE))
```

### Problem 2

Read and clean mr. trash wheel, sheet 1
```{r}
#perhaps key together trash item names?
trash_wheel = readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 1, range = "A2:N338") %>% 
  janitor::clean_names() %>% 
  filter(dumpster != "NA") %>% 
  mutate(month = tolower(month)) %>% 
  mutate(sports_balls = as.integer(round(sports_balls, digits = 0)))
```

Read and clean precipitation data for 2016 and 2017
```{r}
precipitation_2016 = readxl::read_excel(path = "./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 5, range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(
    month = month.abb[month], 
    month = tolower(month),
    year = 2016) %>% 
  rename(prcp_inches = total)


mr_trash_wheel_precip_data_2016 =
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 5, range = "A2:B15") %>% 
  janitor::clean_names() %>%
  filter(!is.na(total)) %>%
  select(month, total_precipitation = total) %>% 
  mutate(month = month.name[month])

```





